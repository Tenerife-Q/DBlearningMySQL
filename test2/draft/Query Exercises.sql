-- ═══════════════════════════════════════════════════════════════════════════════
-- 📝 Day 1 SQL 查询练习题
-- 📅 练习日期：2025-12-26
-- 🎯 题型：简单查询（完整语句） + 复杂逻辑（填空/补全）
-- ═══════════════════════════════════════════════════════════════════════════════


-- ═══════════════════════════════════════════════════════════════════════════════
-- 测试数据（与复习总结相同，可直接运行）
-- ═══════════════════════════════════════════════════════════════════════════════

DROP DATABASE IF EXISTS sql_exam;
CREATE DATABASE sql_exam DEFAULT CHARSET utf8mb4;
USE sql_exam;

-- 学生表
CREATE TABLE student (
    sno CHAR(9) PRIMARY KEY COMMENT '学号',
    sname VARCHAR(20) NOT NULL COMMENT '姓名',
    ssex CHAR(2) CHECK (ssex IN ('男', '女')) COMMENT '性别',
    sage SMALLINT COMMENT '年龄',
    sdept VARCHAR(20) COMMENT '所在系'
) COMMENT '学生表';

INSERT INTO student VALUES
    ('200215121', '李勇', '男', 20, 'CS'),
    ('200215122', '刘晨', '女', 19, 'CS'),
    ('200215123', '王敏', '女', 18, 'MA'),
    ('200215124', '张立', '男', 19, 'IS'),
    ('200215125', '陈新', '男', 22, 'CS'),
    ('200215126', '赵雷', '男', 21, 'MA'),
    ('200215127', '周梅', '女', 20, 'IS'),
    ('200215128', '孙华', '女', 17, 'CS');

-- 课程表
CREATE TABLE course (
    cno CHAR(4) PRIMARY KEY COMMENT '课程号',
    cname VARCHAR(40) NOT NULL COMMENT '课程名',
    cpno CHAR(4) COMMENT '先行课',
    ccredit SMALLINT COMMENT '学分'
) COMMENT '课程表';

INSERT INTO course VALUES
    ('1', '数据库', '5', 4),
    ('2', '数学', NULL, 2),
    ('3', '信息系统', '1', 4),
    ('4', '操作系统', '6', 3),
    ('5', '数据结构', '7', 4),
    ('6', '数据处理', NULL, 2),
    ('7', 'PASCAL语言', '6', 4);

-- 选课表
CREATE TABLE sc (
    sno CHAR(9) NOT NULL COMMENT '学号',
    cno CHAR(4) NOT NULL COMMENT '课程号',
    grade SMALLINT COMMENT '成绩',
    PRIMARY KEY (sno, cno),
    FOREIGN KEY (sno) REFERENCES student(sno),
    FOREIGN KEY (cno) REFERENCES course(cno)
) COMMENT '选课表';

INSERT INTO sc VALUES
    ('200215121', '1', 92),
    ('200215121', '2', 85),
    ('200215121', '3', 88),
    ('200215122', '1', 90),
    ('200215122', '2', 80),
    ('200215123', '2', 95),
    ('200215124', '1', 58),
    ('200215124', '2', 76),
    ('200215124', '3', 82),
    ('200215125', '1', 45),
    ('200215125', '2', 60),
    ('200215126', '2', 88),
    ('200215127', '1', 72),
    ('200215127', '3', 65);


-- ═══════════════════════════════════════════════════════════════════════════════
-- 第一部分：简单查询题（写完整SQL语句）
-- ═══════════════════════════════════════════════════════════════════════════════

/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 1                                                                    │
│ 查询全体学生的学号和姓名                                                      │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 2                                                                    │
│ 查询计算机科学系（CS）全体学生的姓名                                           │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 3                                                                    │
│ 查询年龄在18~20岁之间的学生姓名、系别和年龄                                    │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 4                                                                    │
│ 查询选修了课程的学生学号（去除重复）                                           │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 5                                                                    │
│ 查询姓"刘"的学生的姓名、学号和性别                                            │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 6                                                                    │
│ 查询姓名中第2个字为"晨"的学生的姓名和学号                                      │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 7                                                                    │
│ 查询缺少成绩的学生的学号和相应的课程号                                         │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 8                                                                    │
│ 查询CS系或MA系年龄不大于20岁的学生姓名和年龄                                   │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 9                                                                    │
│ 查询选修了课程号为"1"的学生学号和成绩，按成绩降序排列                           │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 10                                                                   │
│ 查询全体学生信息，按系升序排列，同一系的学生按年龄降序排列                       │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




-- ═══════════════════════════════════════════════════════════════════════════════
-- 第二部分：聚合与分组题（写完整SQL语句）
-- ═══════════════════════════════════════════════════════════════════════════════

/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 11                                                                   │
│ 查询学生总人数                                                               │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 12                                                                   │
│ 查询选修了课程的学生人数                                                      │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 13                                                                   │
│ 查询课程号为"1"的课程的平均成绩                                               │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 14                                                                   │
│ 查询各个课程号及相应的选课人数                                                │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 15                                                                   │
│ 查询选修了3门及以上课程的学生学号                                             │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




-- ═══════════════════════════════════════════════════════════════════════════════
-- 第三部分：连接查询题（写完整SQL语句）
-- ═══════════════════════════════════════════════════════════════════════════════

/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 16                                                                   │
│ 查询每个学生的学号、姓名、选修的课程名及成绩                                   │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 17                                                                   │
│ 查询选修"数据库"课程且成绩在90分以上的学生学号和姓名                           │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 18                                                                   │
│ 查询每门课程的课程号、课程名和先行课的课程名（自连接）                          │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 19                                                                   │
│ 查询所有学生的选课情况，包括没有选课的学生（左外连接）                          │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




-- ═══════════════════════════════════════════════════════════════════════════════
-- 第四部分：嵌套查询题（写完整SQL语句）
-- ═══════════════════════════════════════════════════════════════════════════════

/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 20                                                                   │
│ 查询与"刘晨"在同一个系学习的学生姓名和系别                                     │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 21                                                                   │
│ 查询选修了课程号为"2"的学生姓名                                               │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 22                                                                   │
│ 查询没有选修课程号为"1"的学生姓名                                             │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 23                                                                   │
│ 查询其他系中比CS系所有学生年龄都小的学生姓名和年龄                              │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 24                                                                   │
│ 查询成绩高于该课程平均成绩的选课记录（学号、课程号、成绩）                       │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 25                                                                   │
│ 查询所有选修了课程号为"1"的学生姓名（用 EXISTS 实现）                          │
└─────────────────────────────────────────────────────────────────────────────┘
*/

-- ✏️ 你的答案：




-- ═══════════════════════════════════════════════════════════════════════════════
-- 第五部分：填空补全题（填写关键字或代码片段）
-- ═══════════════════════════════════════════════════════════════════════════════

/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 26                                                                   │
│ 补全SQL：查询年龄最大的学生姓名和年龄                                          │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT sname, sage FROM student
WHERE sage = (SELECT _______(sage) FROM student);

-- ✏️ 填空：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 27                                                                   │
│ 补全SQL：查询各系学生人数，只显示人数超过2人的系                               │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT sdept, COUNT(*) AS 人数 FROM student
_______ BY sdept
_______ COUNT(*) > 2;

-- ✏️ 填空1：
-- ✏️ 填空2：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 28                                                                   │
│ 补全SQL：查询选修了课程的学生信息（使用 EXISTS）                               │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT * FROM student s
WHERE _______ (
    SELECT 1 FROM sc WHERE sc.sno = s.sno
);

-- ✏️ 填空：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 29                                                                   │
│ 补全SQL：查询CS系学生及其选课信息，包括没选课的学生                             │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT s.sname, sc.cno, sc.grade
FROM student s
_______ JOIN sc ON s.sno = sc.sno
WHERE s.sdept = 'CS';

-- ✏️ 填空：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 30                                                                   │
│ 补全SQL：查询比CS系某个学生年龄小的其他系学生（使用 ANY）                       │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT sname, sage FROM student
WHERE sdept <> 'CS'
  AND sage < _______ (SELECT sage FROM student WHERE sdept = 'CS');

-- ✏️ 填空：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 31                                                                   │
│ 补全SQL：查询学生选课成绩，按成绩降序排列，取前5名                              │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT s.sname, c.cname, sc.grade
FROM sc
JOIN student s ON sc.sno = s.sno
JOIN course c ON sc.cno = c.cno
ORDER BY sc.grade _______
_______ 5;

-- ✏️ 填空1：
-- ✏️ 填空2：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 32                                                                   │
│ 补全SQL：查询没有选修任何课程的学生                                            │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT * FROM student s
WHERE _______ _______ (
    SELECT 1 FROM sc WHERE sc.sno = s.sno
);

-- ✏️ 填空1：
-- ✏️ 填空2：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 33                                                                   │
│ 补全SQL：查询选修课程号"1"且成绩不及格的学生学号（成绩<60为不及格）             │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT sno FROM sc
WHERE cno = '1' _______ grade < 60;

-- ✏️ 填空：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 34                                                                   │
│ 补全SQL：查询每个学生的总成绩（学号，总成绩），没有成绩显示为0                   │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT s.sno, _______(SUM(sc.grade), 0) AS 总成绩
FROM student s
LEFT JOIN sc ON s. sno = sc. sno
GROUP BY s.sno;

-- ✏️ 填空：




/*
┌─────────────────────────────────────────────────────────────────────────────┐
│ 📌 题目 35                                                                   │
│ 补全SQL：查询平均成绩大于80分的学生学号和平均成绩                              │
└─────────────────────────────────────────────────────────────────────────────┘
*/

SELECT sno, AVG(grade) AS 平均成绩 FROM sc
GROUP BY sno
_______ AVG(grade) > 80;

-- ✏️ 填空：




-- ═══════════════════════════════════════════════════════════════════════════════
-- ═══════════════════════════════════════════════════════════════════════════════
-- 
--                              📋 参考答案与解析
-- 
-- ═══════════════════════════════════════════════════════════════════════════════
-- ═══════════════════════════════════════════════════════════════════════════════


-- =============================================================================
-- 第一部分：简单查询题 答案
-- =============================================================================

-- 【题目 1】查询全体学生的学号和姓名
SELECT sno, sname FROM student;
-- 📝 解析：基础 SELECT，指定需要的字段即可


-- 【题目 2】查询计算机科学系（CS）全体学生的姓名
SELECT sname FROM student WHERE sdept = 'CS';
-- 📝 解析：WHERE 条件过滤，字符串用单引号


-- 【题目 3】查询年龄在18~20岁之间的学生姓名、系别和年龄
SELECT sname, sdept, sage FROM student WHERE sage BETWEEN 18 AND 20;
-- 📝 解析：BETWEEN... AND 包含边界值
-- 💡 等价写法：WHERE sage >= 18 AND sage <= 20


-- 【题目 4】查询选修了课程的学生学号（去除重复）
SELECT DISTINCT sno FROM sc;
-- 📝 解析：DISTINCT 去重，作用于其后所有字段


-- 【题目 5】查询姓"刘"的学生的姓名、学号和性别
SELECT sname, sno, ssex FROM student WHERE sname LIKE '刘%';
-- 📝 解析：% 匹配任意个字符（包括0个）


-- 【题目 6】查询姓名中第2个字为"晨"的学生的姓名和学号
SELECT sname, sno FROM student WHERE sname LIKE '_晨%';
-- 📝 解析：_ 匹配单个字符，第1位任意，第2位为"晨"


-- 【题目 7】查询缺少成绩的学生的学号和相应的课程号
SELECT sno, cno FROM sc WHERE grade IS NULL;
-- 📝 解析：NULL 必须用 IS NULL 判断，不能用 = NULL
-- ⚠️ 本测试数据中没有 NULL 成绩，结果为空


-- 【题目 8】查询CS系或MA系年龄不大于20岁的学生姓名和年龄
SELECT sname, sage FROM student 
WHERE sdept IN ('CS', 'MA') AND sage <= 20;
-- 📝 解析：IN 匹配多个值，AND 连接多条件
-- 💡 等价写法：WHERE (sdept = 'CS' OR sdept = 'MA') AND sage <= 20
-- ⚠️ 注意括号！AND 优先级高于 OR


-- 【题目 9】查询选修了课程号为"1"的学生学号和成绩，按成绩降序排列
SELECT sno, grade FROM sc WHERE cno = '1' ORDER BY grade DESC;
-- 📝 解析：ORDER BY 默认 ASC 升序，DESC 降序


-- 【题目 10】查询全体学生信息，按系升序排列，同一系的学生按年龄降序排列
SELECT * FROM student ORDER BY sdept ASC, sage DESC;
-- 📝 解析：多字段排序，先按第一字段，相同时按第二字段


-- =============================================================================
-- 第二部分：聚合与分组题 答案
-- =============================================================================

-- 【题目 11】查询学生总人数
SELECT COUNT(*) AS 学生总人数 FROM student;
-- 📝 解析：COUNT(*) 统计所有行数


-- 【题目 12】查询选修了课程的学生人数
SELECT COUNT(DISTINCT sno) AS 选课学生人数 FROM sc;
-- 📝 解析：DISTINCT 去重后再 COUNT
-- ⚠️ 不能用 COUNT(sno)，会统计重复的学号


-- 【题目 13】查询课程号为"1"的课程的平均成绩
SELECT AVG(grade) AS 平均成绩 FROM sc WHERE cno = '1';
-- 📝 解析：AVG 自动忽略 NULL 值


-- 【题目 14】查询各个课程号及相应的选课人数
SELECT cno AS 课程号, COUNT(*) AS 选课人数 FROM sc GROUP BY cno;
-- 📝 解析：GROUP BY 分组后，SELECT 只能用分组字段和聚合函数


-- 【题目 15】查询选修了3门及以上课程的学生学号
SELECT sno FROM sc GROUP BY sno HAVING COUNT(*) >= 3;
-- 📝 解析：HAVING 对分组后结果过滤，可以使用聚合函数
-- 💡 对比：WHERE 在分组前过滤，不能用聚合函数


-- =============================================================================
-- 第三部分：连接查询题 答案
-- =============================================================================

-- 【题目 16】查询每个学生的学号、姓名、选修的课程名及成绩
SELECT s.sno, s.sname, c.cname, sc.grade
FROM student s
INNER JOIN sc ON s.sno = sc.sno
INNER JOIN course c ON sc.cno = c.cno;
-- 📝 解析：三表连接，通过外键关联
-- 💡 等价隐式写法：
--    SELECT s.sno, s.sname, c.cname, sc.grade
--    FROM student s, sc, course c
--    WHERE s. sno = sc. sno AND sc. cno = c. cno;


-- 【题目 17】查询选修"数据库"课程且成绩在90分以上的学生学号和姓名
SELECT s.sno, s.sname
FROM student s
INNER JOIN sc ON s.sno = sc.sno
INNER JOIN course c ON sc.cno = c.cno
WHERE c.cname = '数据库' AND sc.grade > 90;
-- 📝 解析：多表连接 + 多条件过滤


-- 【题目 18】查询每门课程的课程号、课程名和先行课的课程名（自连接）
SELECT c1.cno, c1.cname, c2.cname AS 先行课名
FROM course c1
LEFT JOIN course c2 ON c1.cpno = c2.cno;
-- 📝 解析：自连接需要给表起不同别名
-- 💡 使用 LEFT JOIN 保留没有先行课的课程（如"数学"）


-- 【题目 19】查询所有学生的选课情况，包括没有选课的学生（左外连接）
SELECT s.sno, s.sname, sc.cno, sc.grade
FROM student s
LEFT JOIN sc ON s.sno = sc.sno;
-- 📝 解析：LEFT JOIN 保留左表所有记录
-- 💡 没有选课的学生，cno 和 grade 显示为 NULL


-- =============================================================================
-- 第四部分：嵌套查询题 答案
-- =============================================================================

-- 【题目 20】查询与"刘晨"在同一个系学习的学生姓名和系别
SELECT sname, sdept FROM student
WHERE sdept = (SELECT sdept FROM student WHERE sname = '刘晨')
  AND sname != '刘晨';
-- 📝 解析：标量子查询（返回单值），用于 = 比较
-- 💡 等价写法（自连接）：
--    SELECT s1.sname, s1.sdept FROM student s1, student s2
--    WHERE s1.sdept = s2.sdept AND s2.sname = '刘晨' AND s1.sname != '刘晨';


-- 【题目 21】查询选修了课程号为"2"的学生姓名
SELECT sname FROM student
WHERE sno IN (SELECT sno FROM sc WHERE cno = '2');
-- 📝 解析：列子查询（返回一列），用于 IN 匹配
-- 💡 等价写法（JOIN）：
--    SELECT DISTINCT s.sname FROM student s
--    INNER JOIN sc ON s.sno = sc.sno WHERE sc.cno = '2';
-- 💡 等价写法（EXISTS）：
--    SELECT sname FROM student s
--    WHERE EXISTS (SELECT 1 FROM sc WHERE sc.sno = s.sno AND sc.cno = '2');


-- 【题目 22】查询没有选修课程号为"1"的学生姓名
SELECT sname FROM student
WHERE sno NOT IN (SELECT sno FROM sc WHERE cno = '1');
-- 📝 解析：NOT IN 排除子查询结果
-- 💡 等价写法（NOT EXISTS）：
--    SELECT sname FROM student s
--    WHERE NOT EXISTS (SELECT 1 FROM sc WHERE sc.sno = s.sno AND sc.cno = '1');


-- 【题目 23】查询其他系中比CS系所有学生年龄都小的学生姓名和年龄
SELECT sname, sage FROM student
WHERE sdept != 'CS'
  AND sage < ALL (SELECT sage FROM student WHERE sdept = 'CS');
-- 📝 解析：< ALL 表示小于子查询返回的所有值
-- 💡 等价写法：sage < (SELECT MIN(sage) FROM student WHERE sdept = 'CS')


-- 【题目 24】查询成绩高于该课程平均成绩的选课记录（学号、课程号、成绩）
SELECT sno, cno, grade FROM sc x
WHERE grade > (SELECT AVG(grade) FROM sc y WHERE y.cno = x.cno);
-- 📝 解析：相关子查询，子查询引用外层查询的字段 x. cno
-- 💡 每门课程的平均成绩不同，需要动态计算


-- 【题目 25】查询所有选修了课程号为"1"的学生姓名（用 EXISTS 实现）
SELECT sname FROM student s
WHERE EXISTS (SELECT 1 FROM sc WHERE sc.sno = s.sno AND sc.cno = '1');
-- 📝 解析：EXISTS 判断子查询是否有结果
-- 💡 SELECT 1 是惯用写法，也可用 SELECT * 或 SELECT sno


-- =============================================================================
-- 第五部分：填空补全题 答案
-- =============================================================================

-- 【题目 26】填空：MAX
SELECT sname, sage FROM student
WHERE sage = (SELECT MAX(sage) FROM student);
-- 📝 解析：MAX() 返回最大值


-- 【题目 27】填空1：GROUP   填空2：HAVING
SELECT sdept, COUNT(*) AS 人数 FROM student
GROUP BY sdept
HAVING COUNT(*) > 2;
-- 📝 解析：GROUP BY 分组，HAVING 过滤分组结果


-- 【题目 28】填空：EXISTS
SELECT * FROM student s
WHERE EXISTS (
    SELECT 1 FROM sc WHERE sc. sno = s. sno
);
-- 📝 解析：EXISTS 判断是否存在选课记录


-- 【题目 29】填空：LEFT
SELECT s.sname, sc.cno, sc.grade
FROM student s
LEFT JOIN sc ON s. sno = sc. sno
WHERE s.sdept = 'CS';
-- 📝 解析：LEFT JOIN 保留左表所有记录


-- 【题目 30】填空：ANY
SELECT sname, sage FROM student
WHERE sdept <> 'CS'
  AND sage < ANY (SELECT sage FROM student WHERE sdept = 'CS');
-- 📝 解析：< ANY 表示小于任意一个（即小于最大值）
-- 💡 等价：sage < (SELECT MAX(sage) FROM student WHERE sdept = 'CS')


-- 【题目 31】填空1：DESC   填空2：LIMIT
SELECT s.sname, c.cname, sc.grade
FROM sc
JOIN student s ON sc. sno = s. sno
JOIN course c ON sc.cno = c.cno
ORDER BY sc.grade DESC
LIMIT 5;
-- 📝 解析：DESC 降序，LIMIT 5 取前5条


-- 【题目 32】填空1：NOT   填空2：EXISTS
SELECT * FROM student s
WHERE NOT EXISTS (
    SELECT 1 FROM sc WHERE sc.sno = s.sno
);
-- 📝 解析：NOT EXISTS 判断不存在选课记录
-- 💡 等价写法：WHERE sno NOT IN (SELECT sno FROM sc)


-- 【题目 33】填空：AND
SELECT sno FROM sc
WHERE cno = '1' AND grade < 60;
-- 📝 解析：AND 连接多个条件，必须同时满足


-- 【题目 34】填空：IFNULL 或 COALESCE
SELECT s.sno, IFNULL(SUM(sc.grade), 0) AS 总成绩
FROM student s
LEFT JOIN sc ON s.sno = sc.sno
GROUP BY s.sno;
-- 📝 解析：IFNULL(expr, 0) 当 expr 为 NULL 时返回 0
-- 💡 等价：COALESCE(SUM(sc.grade), 0)


-- 【题目 35】填空：HAVING
SELECT sno, AVG(grade) AS 平均成绩 FROM sc
GROUP BY sno
HAVING AVG(grade) > 80;
-- 📝 解析：HAVING 过滤分组后的聚合结果


-- ═══════════════════════════════════════════════════════════════════════════════
-- 📊 关键语法对比总结
-- ═══════════════════════════════════════════════════════════════════════════════

/*
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              🔑 关键语法对比总结                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │ 1️⃣  WHERE vs HAVING                                                     │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │  WHERE                          │  HAVING                              │   │
│  │  ─────────────────────────────  │  ──────────────────────────────────  │   │
│  │  分组前过滤                      │  分组后过滤                          │   │
│  │  不能用聚合函数                  │  可以用聚合函数                       │   │
│  │  WHERE age > 20                 │  HAVING COUNT(*) > 3                 │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │ 2️⃣  IN vs EXISTS                                                        │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │  IN                             │  EXISTS                              │   │
│  │  ─────────────────────────────  │  ──────────────────────────────────  │   │
│  │  子查询结果集小时效率高          │  子查询结果集大时效率高               │   │
│  │  先执行子查询，再匹配            │  逐行检查是否存在                     │   │
│  │  WHERE sno IN (SELECT...)       │  WHERE EXISTS (SELECT 1...)          │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │ 3️⃣  INNER JOIN vs LEFT JOIN                                             │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │  INNER JOIN                     │  LEFT JOIN                           │   │
│  │  ─────────────────────────────  │  ──────────────────────────────────  │   │
│  │  只返回匹配的记录                │  返回左表所有记录                     │   │
│  │  两表交集                        │  左表全部 + 右表匹配                  │   │
│  │  无匹配则不显示                  │  无匹配显示 NULL                      │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │ 4️⃣  ANY vs ALL                                                          │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │  ANY（SOME）                    │  ALL                                 │   │
│  │  ─────────────────────────────  │  ──────────────────────────────────  │   │
│  │  满足任意一个即可                │  必须满足所有                         │   │
│  │  > ANY ⟺ > MIN                 │  > ALL ⟺ > MAX                       │   │
│  │  < ANY ⟺ < MAX                 │  < ALL ⟺ < MIN                       │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │ 5️⃣  常见等价写法                                                         │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                         │   │
│  │  BETWEEN a AND b        ⟺  >= a AND <= b                               │   │
│  │  IN (a, b, c)           ⟺  = a OR = b OR = c                           │   │
│  │  NOT IN (...)           ⟺  <> ALL (...)                                │   │
│  │  > ANY (...)            ⟺  > (SELECT MIN(... ))                         │   │
│  │  > ALL (...)            ⟺  > (SELECT MAX(...))                         │   │
│  │  LEFT JOIN + IS NULL    ⟺  NOT EXISTS                                  │   │
│  │  INNER JOIN             ⟺  FROM t1, t2 WHERE t1.id = t2.id             │   │
│  │                                                                         │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │ 6️⃣  NULL 值处理要点                                                      │   │
│  ├─────────────────────────────────────────────────────────────────────────┤   │
│  │                                                                         │   │
│  │  ❌ 错误：WHERE grade = NULL                                            │   │
│  │  ✅ 正确：WHERE grade IS NULL                                           │   │
│  │                                                                         │   │
│  │  ❌ 错误：WHERE grade != NULL                                           │   │
│  │  ✅ 正确：WHERE grade IS NOT NULL                                       │   │
│  │                                                                         │   │
│  │  💡 聚合函数（除 COUNT(*)）自动忽略 NULL 值                              │   │
│  │  💡 IFNULL(expr, default) 处理 NULL 为默认值                            │   │
│  │                                                                         │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
*/


-- ═══════════════════════════════════════════════════════════════════════════════
-- 📈 练习完成统计
-- ═══════════════════════════════════════════════════════════════════════════════

/*
┌─────────────────────────────────────────────────────────────────────────────┐
│                           📊 练习题统计                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   题型                    题号              数量                             │
│   ──────────────────────────────────────────────────────                    │
│   简单查询                1-10              10 题                            │
│   聚合与分组              11-15             5 题                             │
│   连接查询                16-19             4 题                             │
│   嵌套查询                20-25             6 题                             │
│   填空补全                26-35             10 题                            │
│   ──────────────────────────────────────────────────────                    │
│   合计                                      35 题                            │
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   🎯 核心考点覆盖：                                                          │
│      ✅ SELECT 基础查询（别名、去重、排序、分页）                             │
│      ✅ WHERE 条件过滤（比较、逻辑、模糊、范围）                              │
│      ✅ 聚合函数（COUNT、SUM、AVG、MAX、MIN）                                │
│      ✅ 分组查询（GROUP BY、HAVING）                                         │
│      ✅ 连接查询（INNER、LEFT、RIGHT、SELF JOIN）                            │
│      ✅ 子查询（标量、列、行、EXISTS）                                        │
│      ✅ 关键字对比（ANY/ALL、IN/EXISTS、WHERE/HAVING）                       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

🎉 Day 1 查询语法练习完成！明天继续：完整性、事务、存储过程、触发器！
*/